# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ Telegram –±–æ—Ç–∞

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
- ‚úÖ –ë–æ—Ç —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –¢–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω –≤ .env: `TELEGRAM_BOT_TOKEN`
- ‚úÖ Username –±–æ—Ç–∞: `PrePromo_bot`
- ‚úÖ ID –±–æ—Ç–∞: `8550338957`

### 2. Webhook —É—Å—Ç–∞–Ω–æ–≤–∫–∞
- ‚úÖ Webhook —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ URL: `https://go-doc-generator-backend.onrender.com/api/telegram/webhook`
- ‚úÖ Pending updates: 0
- ‚úÖ –û—à–∏–±–æ–∫ –Ω–µ—Ç

### 3. Backend —Å–µ—Ä–≤–µ—Ä
- ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É 3001
- ‚úÖ Health check —Ä–∞–±–æ—Ç–∞–µ—Ç: `http://localhost:3001/health`
- ‚úÖ Production —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω: `https://go-doc-generator-backend.onrender.com/health`

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –ú–æ–¥—É–ª—å `telegram-bot.js` —Å–æ–∑–¥–∞–Ω –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤:
  - Webhook –æ–ø–ª–∞—Ç—ã (`/api/payments/webhook`)
  - –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ (`/api/subscription/consume`)
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:
  - `/start` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
  - `/subscription` - —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
  - `/usage` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  - `/upgrade` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É

## üìã –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (polling)
```bash
cd backend
node test-telegram-bot.js
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å webhook
curl https://api.telegram.org/bot<TOKEN>/getWebhookInfo

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook (—É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
curl "https://api.telegram.org/bot<TOKEN>/setWebhook?url=https://go-doc-generator-backend.onrender.com/api/telegram/webhook"
```

## üß™ –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–ù–∞–π—Ç–∏ –±–æ—Ç–∞ –≤ Telegram**: `@PrePromo_bot`
2. **–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã**:
   - `/start` - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
   - `/subscription` - —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ (–µ—Å–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω)
   - `/usage` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - `/upgrade` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è polling (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
2. **–î–ª—è production** webhook —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–æ—Ç–æ—Ä—ã–µ:
   - –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ Telegram Login Widget
   - –ò–º–µ—é—Ç `telegram_id` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ Render

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```
TELEGRAM_BOT_TOKEN=8550338957:AAEUbh8MTYl0KIyWlbFlZlUl3sNzmr9UFe8
TELEGRAM_USE_WEBHOOK=true  # –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è webhook
FRONTEND_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.ru
```

## ‚úÖ –°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ –Ω–∞ production.

